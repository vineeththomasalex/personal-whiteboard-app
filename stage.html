<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Whiteboard - Stage View</title>
    <script src="https://res.cdn.office.net/teams-js/2.0.0/js/MicrosoftTeams.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 16px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            height: 100vh;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding: 16px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h2 {
            margin: 0;
            color: #323130;
            font-size: 24px;
        }
        
        .controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .control-btn {
            padding: 8px 16px;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        .control-btn:hover {
            background-color: #f3f2f1;
        }
        
        .hide-btn {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }
        
        .hide-btn:hover {
            background-color: #c82333;
        }
        
        .current-user {
            text-align: center;
            margin-bottom: 16px;
            padding: 12px;
            background: #e3f2fd;
            border-radius: 6px;
            color: #1976d2;
            font-size: 16px;
        }
        
        .shared-canvas {
            flex: 1;
            border: 3px solid #0078d4;
            border-radius: 8px;
            background: white;
            margin: 8px 0;
            position: relative;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .placeholder {
            color: #666;
            font-size: 18px;
            text-align: center;
            padding: 40px;
        }
        
        .participants-bar {
            margin-top: 16px;
            padding: 16px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .participants-title {
            margin: 0 0 12px 0;
            font-size: 14px;
            color: #323130;
            font-weight: 600;
        }
        
        .participants-grid {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .participant-thumbnail {
            width: 100px;
            height: 80px;
            border: 2px solid #d1d1d1;
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background: white;
            transition: border-color 0.2s;
            font-size: 12px;
            text-align: center;
            padding: 8px;
            box-sizing: border-box;
        }
        
        .participant-thumbnail:hover {
            border-color: #0078d4;
        }
        
        .participant-thumbnail.active {
            border-color: #0078d4;
            background-color: #f3f8ff;
        }
        
        .participant-name {
            margin-top: 4px;
            font-weight: 500;
        }
        
        .canvas-preview {
            width: 60px;
            height: 40px;
            background: #f9f9f9;
            border: 1px solid #e1e1e1;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h2>üì∫ Shared Whiteboard</h2>
        <div class="controls">
            <button class="control-btn" onclick="previousParticipant()">‚¨ÖÔ∏è Previous</button>
            <button class="control-btn" onclick="nextParticipant()">‚û°Ô∏è Next</button>
            <button class="control-btn hide-btn" onclick="hideFromStage()">‚ùå Hide from Stage</button>
        </div>
    </div>
    
    <div class="current-user">
        Currently showing: <strong id="current-participant">John Doe</strong>'s whiteboard
    </div>
    
    <div class="shared-canvas">
        <div class="placeholder">
            üé® Selected participant's whiteboard will appear here<br>
            <small>(This would show the actual canvas content in a real implementation)</small>
        </div>
    </div>
    
    <div class="participants-bar">
        <div class="participants-title">Select participant to display:</div>
        <div class="participants-grid">
            <div class="participant-thumbnail" onclick="selectParticipant('John Doe', this)">
                <div class="canvas-preview">‚úèÔ∏èüìù</div>
                <div class="participant-name">John Doe</div>
            </div>
            <div class="participant-thumbnail active" onclick="selectParticipant('Jane Smith', this)">
                <div class="canvas-preview">üé®üñçÔ∏è</div>
                <div class="participant-name">Jane Smith</div>
            </div>
            <div class="participant-thumbnail" onclick="selectParticipant('Mike Johnson', this)">
                <div class="canvas-preview">üìäüìà</div>
                <div class="participant-name">Mike Johnson</div>
            </div>
            <div class="participant-thumbnail" onclick="selectParticipant('Sarah Wilson', this)">
                <div class="canvas-preview">üí°‚ú®</div>
                <div class="participant-name">Sarah Wilson</div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Teams SDK
        microsoftTeams.app.initialize().then(() => {
            console.log('Teams stage app initialized');
        });

        let currentParticipantIndex = 1; // Jane Smith is initially selected
        const participants = ['John Doe', 'Jane Smith', 'Mike Johnson', 'Sarah Wilson'];

        function selectParticipant(name, element) {
            // Remove active class from all thumbnails
            document.querySelectorAll('.participant-thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
            });
            
            // Add active class to selected thumbnail
            element.classList.add('active');
            
            // Update current participant display
            document.getElementById('current-participant').textContent = name;
            
            // Update current index
            currentParticipantIndex = participants.indexOf(name);
            
            console.log(`Selected participant: ${name}`);
            
            // In a real implementation, this would load the participant's canvas
            updateCanvas(name);
        }

        function previousParticipant() {
            currentParticipantIndex = (currentParticipantIndex - 1 + participants.length) % participants.length;
            const participant = participants[currentParticipantIndex];
            const thumbnail = document.querySelectorAll('.participant-thumbnail')[currentParticipantIndex];
            selectParticipant(participant, thumbnail);
        }

        function nextParticipant() {
            currentParticipantIndex = (currentParticipantIndex + 1) % participants.length;
            const participant = participants[currentParticipantIndex];
            const thumbnail = document.querySelectorAll('.participant-thumbnail')[currentParticipantIndex];
            selectParticipant(participant, thumbnail);
        }

        function hideFromStage() {
            if (confirm('Hide whiteboard from stage? This will remove it from all meeting participants.')) {
                // In a real implementation, this would hide the stage app
                alert('Whiteboard hidden from stage!');
                console.log('Hiding from stage...');
                
                // For demo purposes, just show a message
                document.querySelector('.shared-canvas').innerHTML = `
                    <div class="placeholder">
                        ‚úÖ Whiteboard hidden from stage<br>
                        <small>Meeting participants can no longer see the shared whiteboard</small>
                    </div>
                `;
            }
        }

        function updateCanvas(participantName) {
            // Simulate different canvas content for different participants
            const canvasContent = {
                'John Doe': 'üìù Notes and diagrams',
                'Jane Smith': 'üé® Creative sketches', 
                'Mike Johnson': 'üìä Charts and graphs',
                'Sarah Wilson': 'üí° Ideas and brainstorming'
            };
            
            const content = canvasContent[participantName] || 'Whiteboard content';
            
            document.querySelector('.shared-canvas').innerHTML = `
                <div class="placeholder">
                    üé® ${content}<br>
                    <small>(This would show ${participantName}'s actual canvas in a real implementation)</small>
                </div>
            `;
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                previousParticipant();
            } else if (e.key === 'ArrowRight') {
                nextParticipant();
            } else if (e.key === 'Escape') {
                hideFromStage();
            }
        });

        // Initialize with Jane Smith selected
        updateCanvas('Jane Smith');
    </script>
</body>
</html>